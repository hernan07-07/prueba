function doGet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Invitados");
  var data = sheet.getDataRange().getValues();
  data.shift(); // Quita encabezados
  return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Invitados");
  var input = JSON.parse(e.postData.contents);
  if (sheet.getLastRow() > 1) sheet.getRange(2, 1, sheet.getLastRow() - 1, 5).clearContent();
  if (input.data && input.data.length > 0) {
    var rows = input.data.map(function(i) { return [i.id, i.mesa, i.nombre, i.tarjeta, i.obs]; });
    sheet.getRange(2, 1, rows.length, 5).setValues(rows);
  }
  return ContentService.createTextOutput("Sincronizado");
}